{% extends "_layout" %}

{% block content %}
<section class="uk-section uk-padding-remove uk-section-primary uk-text-center uk-flex uk-flex-center uk-flex-middle" uk-height-viewport="offset-top: true; expand: true">
	<div class="uk-grid-match uk-grid-collapse uk-child-width-1-1" uk-grid>
		{% for group in craft.entries.section('groups') %}
		<div class="">
			<div class="" >
			</div>
			<div class="uk-grid-match uk-grid-collapse uk-child-width-1-3@s uk-flex-center uk-flex-middle uk-text-center  uk-margin-small-top uk-margin-small-bottom" uk-grid>
				<div class="">
					<div class="uk-card uk-card-small uk-card-body">
						<div class="uk-h1 uk-margin-remove"><a class="" href="{{group.url}}">{{group.title}}</a></div>
						<div class="uk-text-meta uk-text-success"></div>
					</div>
				</div>
				{% set next = craft.entries.section('sessions').relatedTo(group).orderBy('schedule desc').schedule('>= '~ now|atom).one() %}
				{% if next|length %}
				<div class="">
					<div class="uk-card uk-card-small uk-card-body uk-card-secondary">
						<div class="">Prochain entraînement</div>
						<div class="uk-h4 uk-margin-remove"><a class="" href="{{next.url}}">Dans {{ next.schedule.diff(now)|date("%d jours %hh et %im") }}</a></div>
						<div class="uk-text-meta">{{next.schedule|date('l d')|ucfirst}} à {{next.schedule|time('short')}}</div>
					</div>
				</div>
				{% else %}
				<div class="">
					<div class="uk-card uk-card-small uk-card-body uk-card-secondary">
						<div class="uk-h4">—</div>
						<div class="uk-text-meta uk-text-success">Pas d'entraînement programmé prochainement</div>
					</div>
				</div>
				{% endif %}
				<div class="uk-visible@s">
					<div class="uk-card uk-card-small uk-card-body uk-text-left">
						{% set nexts = craft.entries.section('sessions').relatedTo(group).orderBy('schedule desc').schedule('<= '~ now|atom).limit(3) %}
						{% if nexts|length %}
						<div class="uk-h4 uk-margin-remove"><a class="" href="{{group.url}}">Prochaines sessions</a></div>
						{% for s in nexts %}
						<div class="uk-text-meta"><a class="" href="{{s.url}}">{{s.schedule|date('l d')|ucfirst}} à {{s.schedule|time('short')}}</a></div>
						{% endfor %}
						{% endif %}
					</div>
				</div>
			</div>
			{% endfor %}
		</div>
	</div>
</section>
<section class="uk-section uk-section-secondary uk-flex uk-flex-center uk-flex-middle uk-text-center uk-height-small">
	<div class="uk-h1"><a href="{{ url('drills') }}">Programmes et drills</a></div>
</section>
<section class="uk-section uk-section-default uk-flex uk-flex-center uk-flex-middle uk-text-center uk-height-small">
	<div class="uk-h1"><a href="{{ url('trainer') }}">Backend</a></div>
</section>

{% endblock %}
